# 単結晶引張試験

## 概要
金って非常にやわらかい材料です。引っ張っているとき、原子的にどのようにふるまっているのだろう？
シミュレーションソフトを使い、原子レベルで結晶がどのように動いているのか調べたくなった。
比較として、よく知られる銀と銅についてもシミュレーションした。挙動に違いがみられそうだ。

## 環境
- **Python**: 3.12 (`.venv/` に仮想環境)
- **LAMMPS**: `/home/iwash/lammps/build/lmp` (ソースビルド版)
- **Quantum ESPRESSO**: `/home/iwash/qe/build/bin/` (v7.4, ソースビルド版)
- **Platform**: WSL2 (Ubuntu 24.04) on Windows
- **RunPod**: クラウドGPUによるリモート実行環境

使用したプログラム：simulations\single_crystal_tensile\single_crystal_tensile.py
  プログラムの概要
  　ase.build.bulk() で完全な周期結晶を構築し、fix deform (z軸) + fix npt (x,y側面ゼロ圧) で変形試験を行う。
  　結晶方位（Miller指数）でz軸＝負荷軸の結晶学的方向を指定する。

### 前実験（プログラムの妥当性評価_解析時間 ~2分程度）
シミュレーションにおいて、金が本当にやわらかくなるのかを確認した。
少ない原子スケール(6x6x6原子程度)で引張試験を行い、耐力を比較した。
また、金属は結晶なので特有の並びがいくつかあるので、代表的な{100},{110},{111}を引張軸とするように、結晶方向によって耐力がどのように変化することを確認した。

およその傾向として、銅>銀>金 の順で耐力が小さくなり、これは予想通りである。

シュミット測によれば、{111}が最も高い応力になり、{110}と{100}が同程度の応力値になると思われたが、いずれも、{110}が最も低い結果になった。これは予想外である。
原子数が少なすぎることやひずみ速度が速いことが結果に影響しているのだろうか？
この前実験では、{100}と{110}の違いについて、結果がよくわからなかったので、
より正確な実験になるように、原子スケール（境界ボックスサイズ）を大きくしたり、ひずみ速度を低下させたりする必要があると思われる。

また、どのように変形するのかという視点が、当初実験の目的であったが、降伏後、応力が急落したところで解析を止めているので、
これについては詳しい調査はできていない。（降伏後の回転は、実際の現象と乖離すると考えたため。）

### 前実験 実験結果
--- Summary (Sorted by name) ---
Cu111_tension_300K_L21.69_maxe1_hdrop2_tf100_df500_triclinicTrue: Max Stress = 12.055 GPa at Strain = 10.92%
Cu100_tension_300K_L21.69_maxe1_hdrop2_tf100_df500_triclinicTrue: Max Stress = 9.479 GPa at Strain = 13.80%
Cu110_tension_300K_L21.69_maxe1_hdrop2_tf100_df500_triclinicTrue: Max Stress = 6.114 GPa at Strain = 6.84%

--- Summary (Sorted by name) ---
Au111_tension_300K_a4.078_L24.47_maxe1_hdrop2_tf100_df500_triclinicTrue: Max Stress = 8.214 GPa at Strain = 9.04%
Au100_tension_300K_a4.078_L24.47_maxe1_hdrop2_tf100_df500_triclinicTrue: Max Stress = 3.394 GPa at Strain = 6.96%
Au110_tension_300K_a4.078_L24.47_maxe1_hdrop2_tf100_df500_triclinicTrue: Max Stress = 2.524 GPa at Strain = 5.38%

--- Summary (Sorted by name) ---
Ag111_tension_300K_a4.09_L24.54_maxe1_hdrop1.5_tf100_df500_triclinicTrue: Max Stress = 7.963 GPa at Strain = 8.58%
Ag100_tension_300K_a4.09_L24.54_maxe1_hdrop1.5_tf100_df500_triclinicTrue: Max Stress = 5.183 GPa at Strain = 8.70%
Ag110_tension_300K_a4.09_L24.54_maxe1_hdrop1.5_tf100_df500_triclinicTrue: Max Stress = 3.174 GPa at Strain = 5.92%

#### 前実験に使用したコマンド Cu
.venv/bin/python3 simulations/single_crystal_tensile/single_crystal_tensile.py --element Cu --lattice 3.615 --potential potentials/Cu_zhou.eam.alloy --pair-style eam/alloy --miller 1 0 0 --max-strain 1.0 --target-size 21.69 --triclinic --halt-drop 2.0

.venv/bin/python3 simulations/single_crystal_tensile/single_crystal_tensile.py --element Cu --lattice 3.615 --potential potentials/Cu_zhou.eam.alloy --pair-style eam/alloy --miller 1 1 0 --max-strain 1.0 --target-size 21.69 --triclinic --halt-drop 2.0

.venv/bin/python3 simulations/single_crystal_tensile/single_crystal_tensile.py --element Cu --lattice 3.615 --potential potentials/Cu_zhou.eam.alloy --pair-style eam/alloy --miller 1 1 1 --max-strain 1.0 --target-size 21.69 --triclinic --halt-drop 2.0

#### 前実験に使用したコマンド Ag
.venv/bin/python3 simulations/single_crystal_tensile/single_crystal_tensile.py --element Ag  --lattice 4.09 --potential potentials/Ag_u3.eam --pair-style eam --miller 1 0 0 --max-strain 1.0 --target-size 24.54  --triclinic --halt-drop 2.0

.venv/bin/python3 simulations/single_crystal_tensile/single_crystal_tensile.py --element Ag  --lattice 4.09 --potential potentials/Ag_u3.eam --pair-style eam --miller 1 1 0 --max-strain 1.0 --target-size 24.54  --triclinic --halt-drop 2.0

.venv/bin/python3 simulations/single_crystal_tensile/single_crystal_tensile.py --element Ag  --lattice 4.09 --potential potentials/Ag_u3.eam --pair-style eam --miller 1 1 1 --max-strain 1.0 --target-size 24.54  --triclinic --halt-drop 2.0

#### 前実験に使用したコマンド Au
.venv/bin/python3 simulations/single_crystal_tensile/single_crystal_tensile.py --element Au --lattice 4.078 --potential potentials/Au_u3.eam --pair-style eam --miller 1 0 0 --max-strain 1.0 --target-size 24.47  --triclinic --halt-drop 2.0

.venv/bin/python3 simulations/single_crystal_tensile/single_crystal_tensile.py --element Au --lattice 4.078 --potential potentials/Au_u3.eam --pair-style eam --miller 1 1 0 --max-strain 1.0 --target-size 24.47  --triclinic --halt-drop 2.0

.venv/bin/python3 simulations/single_crystal_tensile/single_crystal_tensile.py --element Au --lattice 4.078 --potential potentials/Au_u3.eam --pair-style eam --miller 1 1 1 --max-strain 1.0 --target-size 24.47  --triclinic --halt-drop 2.0

### 本番実験

#### 前実験からの改善点
前実験では以下の問題があった：
1. **原子数が少なすぎる（864個）** → 熱揺らぎが大きく、応力-ひずみ曲線のS/N比が悪い。特にAuの{100},{110}は弾性域すら明瞭でなかった。
2. **ひずみ速度が速い（0.001 /ps = 10^9 /s）** → 転位核生成のタイミングに影響しうる。

これらを踏まえ、本番実験では以下のように条件を変更する：

| パラメータ | 前実験 | 本番実験 | 変更理由 |
|---|---|---|---|
| target_size | ~22-24 Å | **50 Å** | 原子数を増加。揺らぎを低減 |
| ひずみ速度 | 0.001 /ps | **0.0005 /ps** | より準静的な条件に近づける |
| 実行環境 | ローカルCPU | **RunPod GPU** | 大規模系の計算を高速化 |

その他の条件は前実験から変更なし（温度300K、triclinic有効、halt-drop 2.0 GPa）。

#### 本番実験条件
- **材料**: Cu, Ag, Au（3種）
- **方位**: {100},{110},{111}
- **target_size**: 50 Å
- **ひずみ速度**: 0.0005 /ps (5×10^8 /s)
- **温度**: 300 K
- **max_strain**: 0.30
- **halt-drop**: 2.0 GPa
- **triclinic**: 有効
- **実行環境**: RunPod GPU

#### 本番実験コマンド（{hkl}= {100},{110},{111}）

```bash
# Cu
.venv/bin/python3 simulations/single_crystal_tensile/single_crystal_tensile.py \
  --element Cu --lattice 3.615 --potential potentials/Cu_zhou.eam.alloy --pair-style eam/alloy \
  --miller h k l --target-size 50 --erate 0.0005 --max-strain 0.30 \
  --triclinic --halt-drop 2.0 --runpod --gpu

# Ag
.venv/bin/python3 simulations/single_crystal_tensile/single_crystal_tensile.py \
  --element Ag --lattice 4.09 --potential potentials/Ag_u3.eam --pair-style eam \
  --miller h k l --target-size 50 --erate 0.0005 --max-strain 0.30 \
  --triclinic --halt-drop 2.0 --runpod --gpu

# Au
.venv/bin/python3 simulations/single_crystal_tensile/single_crystal_tensile.py \
  --element Au --lattice 4.078 --potential potentials/Au_u3.eam --pair-style eam \
  --miller h k l --target-size 50 --erate 0.0005 --max-strain 0.30 \
  --triclinic --halt-drop 2.0 --runpod --gpu
```

#### 本番実験結果

##### Cu（銅）
| 方位 | 最大応力 (GPa) | 最大応力時ひずみ (%) | 破断ひずみ (%) | 曲線の特徴 |
|---|---|---|---|---|
| {100} | 9.41 | ~14 | ~14 | 緩やかな増加を続け、最後に急落。 |
| {110} | 5.72 | ~6 | ~7 | 最も低応力。 |
| {111} | 11.24 | ~9 | ~10 | 最も高応力。 |

##### Ag（銀）
| 方位 | 最大応力 (GPa) | 最大応力時ひずみ (%) | 破断ひずみ (%) | 曲線の特徴 |
|---|---|---|---|---|
| {100} | 5.19 | ~9 | ~9 | ピーク後に急落 |
| {110} | 2.94 | ~6 | ~7 | 最も低応力。 |
| {111} | 7.60 | ~8 | ~8 | 最も高応力。 |

##### Au（金）
| 方位 | 最大応力 (GPa) | 最大応力時ひずみ (%) | 破断ひずみ (%) | 曲線の特徴 |
|---|---|---|---|---|
| {100} | 3.47 | ~9 | ~9 | 応力レベルが低い。ひずみ8%付近で応力降下するが、その後も低応力で伸び続ける。試験中止機能が適切に働いていない。 |
| {110} | 2.06 | ~6 | ~10 | 最も低応力（全9条件中でも最低）。ひずみ7%付近で応力降下するが、その後も低応力で伸び続ける。試験中止機能が適切に働いていない。 |
| {111} | 7.68 | ~8 | ~8 | 最も高応力。Ag{111}とほぼ同等の値 |

##### 全体の傾向
- **方位依存性**: 全元素で {111} > {100} > {110} の順に最大応力が高い。（前実験と同じ傾向）
- **元素依存性（最大応力）**: 同じ方位で比較すると Cu > Au ≈ Ag の順。ただし{111}ではAu(7.68)とAg(7.60)がほぼ同値で、Cu(11.24)が突出して高い。
- **元素依存性（{100},{110}）**: {100}と{110}では Cu >> Ag > Au の順であり、金が最もやわらかいという傾向が明確に現れた。
- **応力降下パターン**: すべての条件で、最大応力到達後に急激な応力降下が見られた。これは転位核生成による降伏と考えられる。
- **前実験との比較**: 方位依存性の順序（{111}>{100}>{110}）は前実験と一致。原子数増加・ひずみ速度低下により、応力-ひずみ曲線のS/N比が改善され、弾性域と降伏点がより明瞭になった。
- **{110}と{100}の関係性の逆転** 引張初期では{110}の方が高い応力だが、ひずみが進行するにつれて、{100}の方が値が高くなる。{110}は低いひずみで急降下し、{100}はその後もよく伸びて高い応力になったところで急降下する。

### 考察

#### 疑問1: {110}と{100}の応力-ひずみ曲線が逆転するのはなぜか？

全元素で共通して、引張初期は{110}の方が{100}より高い応力を示すが、ひずみが進むと{100}が{110}を追い越し、最終的に{100}の方が高い最大応力に達する。

**仮説**: FCC金属の弾性異方性（Zener比 A > 1）により、ヤング率は E[110] > E[100] である。そのため弾性域では{110}の方が高い応力になる。一方、格子不安定性（理想強度）に到達するひずみは方位によって異なり、{110}は活性化されるすべり系が少なく（4つ）、応力がせん断方向に集中しやすいため低ひずみで不安定化する。{100}は8つの等価なすべり系に応力が対称的に分散されるため、せん断局所化が抑制され、より高いひずみまで安定を維持する。結果として「{110}は硬いが早く壊れ、{100}は柔らかいが粘る」という逆転が起きる。

**検証方法**: 各元素・各方位のヤング率をポテンシャルから計算し（弾性定数 C11, C12, C44 → 方位別ヤング率）、弾性域の傾きと一致するか確認する。

#### 疑問2: Au{111}とAg{111}の最大応力がほぼ一致するのはなぜか？

Au{111}=7.68 GPa、Ag{111}=7.60 GPa と、元素が異なるにもかかわらず最大応力がほぼ同値である。一方、{100}や{110}では Au < Ag と明確な差がある。

**仮説**: {111}方向の理想強度は、{111}面上の不安定積層欠陥エネルギー（γ_us）に強く支配される。Au_u3.eamとAg_u3.eamは格子定数がほぼ同じ（4.080 vs 4.090 Å）であり、結晶の幾何学的環境が近い。もしγ_usも近い値であれば、{111}理想強度の一致が説明できる。{100}や{110}では複数のすべり系の競合や格子不安定性の経路が複雑なため、埋め込み関数F(ρ)やペアポテンシャルZ(r)の違いが現れやすい。

**検証方法**: LAMMPSで一般化積層欠陥エネルギー（GSF曲線）を計算し、Au・Ag・Cuのγ_usを直接比較する。

### 追加検証項目

- [ ] **検証A: 弾性定数の計算** — 各ポテンシャル（Cu_zhou, Ag_u3, Au_u3）からC11, C12, C44を求め、方位別ヤング率 E[100], E[110], E[111] を算出する。応力-ひずみ曲線の弾性域の傾きと比較し、疑問1の仮説を検証する。
- [ ] **検証B: 一般化積層欠陥エネルギー（GSF）の計算** — {111}面を<112>方向にずらしたときのエネルギー曲線（GSF曲線）をAu, Ag, Cuについて計算し、不安定積層欠陥エネルギーγ_usを比較する。Au ≈ Ag < Cu であれば、疑問2の仮説が支持される。

